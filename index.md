
Zero Hydra <span>Failure</span> Hackathon
====

Дважды в год, в канун нового релиза NixOS, в Nixpkgs приходит ZHF. Все мейнтейнеры забывают былые распри и раздоры, и вместе уменьшают количество ошибок на Гидре.

В этом году попробуем дать ему физическую манифестацию!

Специально обученный человек будет всегда держать огромные количества чая, будут закуски и общий заказ еды -- всё, чтобы хакать без остановок.


-----

## Уровень

От приходящего человека требуется иметь понимание Nix, и ноутбук с ним.

У вас осталось <span id="there-is-time" color="red">(наверное) время</span>, чтобы прочитать [немного гайдов по Nix](https://nixos.org/learn.html).

Добавляйтесь [в наш уютный чат](https://t.me/ru_nixos)!

## Место/Время
*19 ноября, в |TO_BE_ANNOUNCED|*

## Как участвовать?
```nix
let
  how_to_add = thing:
  "Добавьте ${thing} через PR, или напишите t.me/cabiarangris";
in
  builtins.map how_to_add [ "себя" "лекцию" "воркшоп" ]
```

## Люди

- @balsoft
- @cab404

----
## Лекции

*TBA*

----
## Воркшопы

### Большой ZHF стол
Фигачим-фигачим-фигачим

Задача: поправить максимальное количество ошибок сборки на Гидре.

Обсуждение в nixpkgs: https://github.com/NixOS/nixpkgs/issues/144627

#### Что делать?

1. Зайти в [последнюю сборку пакетов nixpkgs](https://hydra.nixos.org/jobset/nixpkgs/trunk) или [последний прогон тестов NixOS](https://hydra.nixos.org/jobset/nixos/trunk-combined);
2. Найти там несобирающийся пакет или сломанный тест. Можно поискать те, что интересны вам, а можно взять первый попавшийся;
3. (Не советуем пропускать!) Поискать, есть ли в nixpkgs PR, который исправляет проблему. Если он есть, то попробовать собрать, оставить соответствующее ревью, и GOTO 1;
4. Если PR нет, то попробовать найти причину проблемы и исправить её;
5. Открыть PR в nixpkgs с решением проблемы. Если решение проблемы вызывает пересборку множества пакетов, то открывайте PR в staging, а в противном случае -- в master.
6. GOTO 1

#### Зачем это нужно?

Релизы nixpkgs/NixOS должны быть стабильными и хорошо работать, поэтому перед их выпуском внимание мейнтейнеров сосредотачивается на исправлении ошибок, а не добавлении новых пакетов или модулей. Чем меньше ошибок на Гидре, тем более полным будет новый релиз.

#### Что делать, если я недостаточно умею в Nix?

Вы всё равно можете помочь! Попробуйте собрать и протестировать чужие PR, исправляющие ошибки.

#### Как тестировать чужие PR?

Установите `nixpkgs-review`, например с помощью `nix-shell -p nixpkgs-review`;

Найдите номер интересующего PR, и запустите `nixpkgs-review $PR`.

### Nix, Rust и микроконтроллеры
Помигайте лампочкой, экраном на железке. Воспроизводимые носимые устройства!

<script>
        zhftimestamp = Date.UTC(2021, 10, 19)
        getTimeLeft = () => {
            delta = (zhftimestamp - Date.now())
            if (delta <= 0) return "(нет)"
            s = Math.ceil(delta / 1000)
            m = Math.ceil(s / 60)
            h = Math.ceil(m / 60)
            d = Math.ceil(h / 24)
            format2 = (str) => ("" + str).length == 1 ? "0" + str : ("" + str)
            return "" +
                format2(d) + ":" +
                format2(h % 24) + ":" +
                format2(m % 60) + ":" +
                format2(s % 60)
        }

        setInterval(() => {
            time_left = document.getElementById("there-is-time")
            time_left.textContent = getTimeLeft()
            new Animation(
                new KeyframeEffect(
                    time_left, [
                        { color: 'red', selector: 0.2},
                        {selector: 1}
                    ],
                    { duration: 200 }
                ),
                document.timeline
            ).play()
        }, 1000)
</script>

<style>
    ::content("Failure") {
        rotate: 5deg;
    }
</style>
